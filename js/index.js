var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) {return typeof obj;} : function (obj) {return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;};(function () {function a(a) {a.remember("_draggable", this), this.el = a;}a.prototype.init = function (a, b) {var c = this;this.constraint = a, this.value = b, this.el.on("mousedown.drag", function (a) {c.start(a);}), this.el.on("touchstart.drag", function (a) {c.start(a);});}, a.prototype.transformPoint = function (a, b) {a = a || window.event;var c = a.changedTouches && a.changedTouches[0] || a;return this.p.x = c.pageX - (b || 0), this.p.y = c.pageY, this.p.matrixTransform(this.m);}, a.prototype.getBBox = function () {var a = this.el.bbox();return this.el instanceof SVG.Nested && (a = this.el.rbox()), (this.el instanceof SVG.G || this.el instanceof SVG.Use || this.el instanceof SVG.Nested) && (a.x = this.el.x(), a.y = this.el.y()), a;}, a.prototype.start = function (a) {if ("click" != a.type && "mousedown" != a.type && "mousemove" != a.type || 1 == (a.which || a.buttons)) {var b = this;if (this.el.fire("beforedrag", { event: a, handler: this }), !this.el.event().defaultPrevented) {a.preventDefault(), a.stopPropagation(), this.parent = this.parent || this.el.parent(SVG.Nested) || this.el.parent(SVG.Doc), this.p = this.parent.node.createSVGPoint(), this.m = this.el.node.getScreenCTM().inverse();var c,d = this.getBBox();if (this.el instanceof SVG.Text) switch (c = this.el.node.getComputedTextLength(), this.el.attr("text-anchor")) {case "middle":c /= 2;break;case "start":c = 0;}this.startPoints = { point: this.transformPoint(a, c), box: d, transform: this.el.transform() }, SVG.on(window, "mousemove.drag", function (a) {b.drag(a);}), SVG.on(window, "touchmove.drag", function (a) {b.drag(a);}), SVG.on(window, "mouseup.drag", function (a) {b.end(a);}), SVG.on(window, "touchend.drag", function (a) {b.end(a);}), this.el.fire("dragstart", { event: a, p: this.startPoints.point, m: this.m, handler: this });}}}, a.prototype.drag = function (a) {var b = this.getBBox(),c = this.transformPoint(a),d = this.startPoints.box.x + c.x - this.startPoints.point.x,e = this.startPoints.box.y + c.y - this.startPoints.point.y,f = this.constraint,g = c.x - this.startPoints.point.x,h = c.y - this.startPoints.point.y;if (this.el.fire("dragmove", { event: a, p: c, m: this.m, handler: this }), this.el.event().defaultPrevented) return c;if ("function" == typeof f) {var i = f.call(this.el, d, e, this.m);"boolean" == typeof i && (i = { x: i, y: i }), i.x === !0 ? this.el.x(d) : i.x !== !1 && this.el.x(i.x), i.y === !0 ? this.el.y(e) : i.y !== !1 && this.el.y(i.y);} else "object" == (typeof f === "undefined" ? "undefined" : _typeof(f)) && (null != f.minX && d < f.minX ? (d = f.minX, g = d - this.startPoints.box.x) : null != f.maxX && d > f.maxX - b.width && (d = f.maxX - b.width, g = d - this.startPoints.box.x), null != f.minY && e < f.minY ? (e = f.minY, h = e - this.startPoints.box.y) : null != f.maxY && e > f.maxY - b.height && (e = f.maxY - b.height, h = e - this.startPoints.box.y), null != f.snapToGrid && (d -= d % f.snapToGrid, e -= e % f.snapToGrid, g -= g % f.snapToGrid, h -= h % f.snapToGrid), this.el instanceof SVG.G ? this.el.matrix(this.startPoints.transform).transform({ x: g, y: h }, !0) : this.el.move(d, e));return c;}, a.prototype.end = function (a) {var b = this.drag(a);this.el.fire("dragend", { event: a, p: b, m: this.m, handler: this }), SVG.off(window, "mousemove.drag"), SVG.off(window, "touchmove.drag"), SVG.off(window, "mouseup.drag"), SVG.off(window, "touchend.drag");}, SVG.extend(SVG.Element, { draggable: function draggable(b, c) {("function" == typeof b || "object" == (typeof b === "undefined" ? "undefined" : _typeof(b))) && (c = b, b = !0);var d = this.remember("_draggable") || new a(this);return b = "undefined" == typeof b ? !0 : b, b ? d.init(c || {}, b) : (this.off("mousedown.drag"), this.off("touchstart.drag")), this;} });}).call(undefined);


/*! svg.resize.js v1.4.2 MIT*/;!function () {"use strict";(function () {function t(t) {t.remember("_resizeHandler", this), this.el = t, this.parameters = {}, this.lastUpdateCall = null, this.p = t.doc().node.createSVGPoint();}t.prototype.transformPoint = function (t, e, i) {return this.p.x = t - (this.offset.x - window.pageXOffset), this.p.y = e - (this.offset.y - window.pageYOffset), this.p.matrixTransform(i || this.m);}, t.prototype._extractPosition = function (t) {return { x: null != t.clientX ? t.clientX : t.touches[0].clientX, y: null != t.clientY ? t.clientY : t.touches[0].clientY };}, t.prototype.init = function (t) {var e = this;if (this.stop(), "stop" !== t) {this.options = {};for (var i in this.el.resize.defaults) {this.options[i] = this.el.resize.defaults[i], void 0 !== t[i] && (this.options[i] = t[i]);}this.el.on("lt.resize", function (t) {e.resize(t || window.event);}), this.el.on("rt.resize", function (t) {e.resize(t || window.event);}), this.el.on("rb.resize", function (t) {e.resize(t || window.event);}), this.el.on("lb.resize", function (t) {e.resize(t || window.event);}), this.el.on("t.resize", function (t) {e.resize(t || window.event);}), this.el.on("r.resize", function (t) {e.resize(t || window.event);}), this.el.on("b.resize", function (t) {e.resize(t || window.event);}), this.el.on("l.resize", function (t) {e.resize(t || window.event);}), this.el.on("rot.resize", function (t) {e.resize(t || window.event);}), this.el.on("point.resize", function (t) {e.resize(t || window.event);}), this.update();}}, t.prototype.stop = function () {return this.el.off("lt.resize"), this.el.off("rt.resize"), this.el.off("rb.resize"), this.el.off("lb.resize"), this.el.off("t.resize"), this.el.off("r.resize"), this.el.off("b.resize"), this.el.off("l.resize"), this.el.off("rot.resize"), this.el.off("point.resize"), this;}, t.prototype.resize = function (t) {var e = this;this.m = this.el.node.getScreenCTM().inverse(), this.offset = { x: window.pageXOffset, y: window.pageYOffset };var i = this._extractPosition(t.detail.event);if (this.parameters = { type: this.el.type, p: this.transformPoint(i.x, i.y), x: t.detail.x, y: t.detail.y, box: this.el.bbox(), rotation: this.el.transform().rotation }, "text" === this.el.type && (this.parameters.fontSize = this.el.attr()["font-size"]), void 0 !== t.detail.i) {var s = this.el.array().valueOf();this.parameters.i = t.detail.i, this.parameters.pointCoords = [s[t.detail.i][0], s[t.detail.i][1]];}switch (t.type) {case "lt":this.calc = function (t, e) {var i = this.snapToGrid(t, e);if (this.parameters.box.width - i[0] > 0 && this.parameters.box.height - i[1] > 0) {if ("text" === this.parameters.type) return this.el.move(this.parameters.box.x + i[0], this.parameters.box.y), void this.el.attr("font-size", this.parameters.fontSize - i[0]);i = this.checkAspectRatio(i), this.el.move(this.parameters.box.x + i[0], this.parameters.box.y + i[1]).size(this.parameters.box.width - i[0], this.parameters.box.height - i[1]);}};break;case "rt":this.calc = function (t, e) {var i = this.snapToGrid(t, e, 2);if (this.parameters.box.width + i[0] > 0 && this.parameters.box.height - i[1] > 0) {if ("text" === this.parameters.type) return this.el.move(this.parameters.box.x - i[0], this.parameters.box.y), void this.el.attr("font-size", this.parameters.fontSize + i[0]);i = this.checkAspectRatio(i), this.el.move(this.parameters.box.x, this.parameters.box.y + i[1]).size(this.parameters.box.width + i[0], this.parameters.box.height - i[1]);}};break;case "rb":this.calc = function (t, e) {var i = this.snapToGrid(t, e, 0);if (this.parameters.box.width + i[0] > 0 && this.parameters.box.height + i[1] > 0) {if ("text" === this.parameters.type) return this.el.move(this.parameters.box.x - i[0], this.parameters.box.y), void this.el.attr("font-size", this.parameters.fontSize + i[0]);i = this.checkAspectRatio(i), this.el.move(this.parameters.box.x, this.parameters.box.y).size(this.parameters.box.width + i[0], this.parameters.box.height + i[1]);}};break;case "lb":this.calc = function (t, e) {var i = this.snapToGrid(t, e, 1);if (this.parameters.box.width - i[0] > 0 && this.parameters.box.height + i[1] > 0) {if ("text" === this.parameters.type) return this.el.move(this.parameters.box.x + i[0], this.parameters.box.y), void this.el.attr("font-size", this.parameters.fontSize - i[0]);i = this.checkAspectRatio(i), this.el.move(this.parameters.box.x + i[0], this.parameters.box.y).size(this.parameters.box.width - i[0], this.parameters.box.height + i[1]);}};break;case "t":this.calc = function (t, e) {var i = this.snapToGrid(t, e, 2);if (this.parameters.box.height - i[1] > 0) {if ("text" === this.parameters.type) return;this.el.move(this.parameters.box.x, this.parameters.box.y + i[1]).height(this.parameters.box.height - i[1]);}};break;case "r":this.calc = function (t, e) {var i = this.snapToGrid(t, e, 0);if (this.parameters.box.width + i[0] > 0) {if ("text" === this.parameters.type) return;this.el.move(this.parameters.box.x, this.parameters.box.y).width(this.parameters.box.width + i[0]);}};break;case "b":this.calc = function (t, e) {var i = this.snapToGrid(t, e, 0);if (this.parameters.box.height + i[1] > 0) {if ("text" === this.parameters.type) return;this.el.move(this.parameters.box.x, this.parameters.box.y).height(this.parameters.box.height + i[1]);}};break;case "l":this.calc = function (t, e) {var i = this.snapToGrid(t, e, 1);if (this.parameters.box.width - i[0] > 0) {if ("text" === this.parameters.type) return;this.el.move(this.parameters.box.x + i[0], this.parameters.box.y).width(this.parameters.box.width - i[0]);}};break;case "rot":this.calc = function (t, e) {var i = { x: t + this.parameters.p.x, y: e + this.parameters.p.y },s = Math.atan2(this.parameters.p.y - this.parameters.box.y - this.parameters.box.height / 2, this.parameters.p.x - this.parameters.box.x - this.parameters.box.width / 2),r = Math.atan2(i.y - this.parameters.box.y - this.parameters.box.height / 2, i.x - this.parameters.box.x - this.parameters.box.width / 2),a = 180 * (r - s) / Math.PI;this.el.center(this.parameters.box.cx, this.parameters.box.cy).rotate(this.parameters.rotation + a - a % this.options.snapToAngle, this.parameters.box.cx, this.parameters.box.cy);};break;case "point":this.calc = function (t, e) {var i = this.snapToGrid(t, e, this.parameters.pointCoords[0], this.parameters.pointCoords[1]),s = this.el.array().valueOf();s[this.parameters.i][0] = this.parameters.pointCoords[0] + i[0], s[this.parameters.i][1] = this.parameters.pointCoords[1] + i[1], this.el.plot(s);};}this.el.fire("resizestart", { dx: this.parameters.x, dy: this.parameters.y, event: t }), SVG.on(window, "touchmove.resize", function (t) {e.update(t || window.event);}), SVG.on(window, "touchend.resize", function () {e.done();}), SVG.on(window, "mousemove.resize", function (t) {e.update(t || window.event);}), SVG.on(window, "mouseup.resize", function () {e.done();});}, t.prototype.update = function (t) {if (!t) return void (this.lastUpdateCall && this.calc(this.lastUpdateCall[0], this.lastUpdateCall[1]));var e = this._extractPosition(t),i = this.transformPoint(e.x, e.y),s = i.x - this.parameters.p.x,r = i.y - this.parameters.p.y;this.lastUpdateCall = [s, r], this.calc(s, r), this.el.fire("resizing", { dx: s, dy: r, event: t });}, t.prototype.done = function () {this.lastUpdateCall = null, SVG.off(window, "mousemove.resize"), SVG.off(window, "mouseup.resize"), SVG.off(window, "touchmove.resize"), SVG.off(window, "touchend.resize"), this.el.fire("resizedone");}, t.prototype.snapToGrid = function (t, e, i, s) {var r;return void 0 !== s ? r = [(i + t) % this.options.snapToGrid, (s + e) % this.options.snapToGrid] : (i = null == i ? 3 : i, r = [(this.parameters.box.x + t + (1 & i ? 0 : this.parameters.box.width)) % this.options.snapToGrid, (this.parameters.box.y + e + (2 & i ? 0 : this.parameters.box.height)) % this.options.snapToGrid]), t -= Math.abs(r[0]) < this.options.snapToGrid / 2 ? r[0] : r[0] - (t < 0 ? -this.options.snapToGrid : this.options.snapToGrid), e -= Math.abs(r[1]) < this.options.snapToGrid / 2 ? r[1] : r[1] - (e < 0 ? -this.options.snapToGrid : this.options.snapToGrid), this.constraintToBox(t, e, i, s);}, t.prototype.constraintToBox = function (t, e, i, s) {var r,a,o = this.options.constraint || {};return void 0 !== s ? (r = i, a = s) : (r = this.parameters.box.x + (1 & i ? 0 : this.parameters.box.width), a = this.parameters.box.y + (2 & i ? 0 : this.parameters.box.height)), void 0 !== o.minX && r + t < o.minX && (t = o.minX - r), void 0 !== o.maxX && r + t > o.maxX && (t = o.maxX - r), void 0 !== o.minY && a + e < o.minY && (e = o.minY - a), void 0 !== o.maxY && a + e > o.maxY && (e = o.maxY - a), [t, e];}, t.prototype.checkAspectRatio = function (t) {if (!this.options.saveAspectRatio) return t;var e = t.slice(),i = this.parameters.box.width / this.parameters.box.height,s = this.parameters.box.width + t[0],r = this.parameters.box.height - t[1],a = s / r;return a < i ? e[1] = s / i - this.parameters.box.height : a > i && (e[0] = this.parameters.box.width - r * i), e;}, SVG.extend(SVG.Element, { resize: function resize(e) {return (this.remember("_resizeHandler") || new t(this)).init(e || {}), this;} }), SVG.Element.prototype.resize.defaults = { snapToAngle: .1, snapToGrid: 1, constraint: {}, saveAspectRatio: !1 };}).call(this);}();

/*! svg.select.js v3.0.1 MIT*/;!function () {"use strict";function i(t) {(this.el = t).remember("_selectHandler", this), this.pointSelection = { isSelected: !1 }, this.rectSelection = { isSelected: !1 }, this.pointsList = { lt: [0, 0], rt: ["width", 0], rb: ["width", "height"], lb: [0, "height"], t: ["width", 0], r: ["width", "height"], b: ["width", "height"], l: [0, "height"] }, this.pointCoord = function (t, e, i) {var s = "string" != typeof t ? t : e[t];return i ? s / 2 : s;}, this.pointCoords = function (t, e) {var i = this.pointsList[t];return { x: this.pointCoord(i[0], e, "t" === t || "b" === t), y: this.pointCoord(i[1], e, "r" === t || "l" === t) };};}i.prototype.init = function (t, e) {var i = this.el.bbox();this.options = {};var s = this.el.selectize.defaults.points;for (var n in this.el.selectize.defaults) {this.options[n] = this.el.selectize.defaults[n], void 0 !== e[n] && (this.options[n] = e[n]);}var o = ["points", "pointsExclude"];for (var n in o) {var r = this.options[o[n]];"string" == typeof r ? r = 0 < r.length ? r.split(/\s*,\s*/i) : [] : "boolean" == typeof r && "points" === o[n] && (r = r ? s : []), this.options[o[n]] = r;}this.options.points = [s, this.options.points].reduce(function (t, e) {return t.filter(function (t) {return -1 < e.indexOf(t);});}), this.options.points = [this.options.points, this.options.pointsExclude].reduce(function (t, e) {return t.filter(function (t) {return e.indexOf(t) < 0;});}), this.parent = this.el.parent(), this.nested = this.nested || this.parent.group(), this.nested.matrix(new SVG.Matrix(this.el).translate(i.x, i.y)), this.options.deepSelect && -1 !== ["line", "polyline", "polygon"].indexOf(this.el.type) ? this.selectPoints(t) : this.selectRect(t), this.observe(), this.cleanup();}, i.prototype.selectPoints = function (t) {return this.pointSelection.isSelected = t, this.pointSelection.set || (this.pointSelection.set = this.parent.set(), this.drawPoints()), this;}, i.prototype.getPointArray = function () {var e = this.el.bbox();return this.el.array().valueOf().map(function (t) {return [t[0] - e.x, t[1] - e.y];});}, i.prototype.drawPoints = function () {for (var n = this, t = this.getPointArray(), e = 0, i = t.length; e < i; ++e) {var s = function (s) {return function (t) {(t = t || window.event).preventDefault ? t.preventDefault() : t.returnValue = !1, t.stopPropagation();var e = t.pageX || t.touches[0].pageX,i = t.pageY || t.touches[0].pageY;n.el.fire("point", { x: e, y: i, i: s, event: t });};}(e),o = this.drawPoint(t[e][0], t[e][1]).addClass(this.options.classPoints).addClass(this.options.classPoints + "_point").on("touchstart", s).on("mousedown", s);this.pointSelection.set.add(o);}}, i.prototype.drawPoint = function (t, e) {var i = this.options.pointType;switch (i) {case "circle":return this.drawCircle(t, e);case "rect":return this.drawRect(t, e);default:if ("function" == typeof i) return i.call(this, t, e);throw new Error("Unknown " + i + " point type!");}}, i.prototype.drawCircle = function (t, e) {return this.nested.circle(this.options.pointSize).center(t, e);}, i.prototype.drawRect = function (t, e) {return this.nested.rect(this.options.pointSize, this.options.pointSize).center(t, e);}, i.prototype.updatePointSelection = function () {var e = this.getPointArray();this.pointSelection.set.each(function (t) {this.cx() === e[t][0] && this.cy() === e[t][1] || this.center(e[t][0], e[t][1]);});}, i.prototype.updateRectSelection = function () {var s = this,n = this.el.bbox();if (this.rectSelection.set.get(0).attr({ width: n.width, height: n.height }), this.options.points.length && this.options.points.map(function (t, e) {var i = s.pointCoords(t, n);s.rectSelection.set.get(e + 1).center(i.x, i.y);}), this.options.rotationPoint) {var t = this.rectSelection.set.length();this.rectSelection.set.get(t - 1).center(n.width / 2, 20);}}, i.prototype.selectRect = function (t) {var n = this,o = this.el.bbox();function r(s) {return function (t) {(t = t || window.event).preventDefault ? t.preventDefault() : t.returnValue = !1, t.stopPropagation();var e = t.pageX || t.touches[0].pageX,i = t.pageY || t.touches[0].pageY;n.el.fire(s, { x: e, y: i, event: t });};}if (this.rectSelection.isSelected = t, this.rectSelection.set = this.rectSelection.set || this.parent.set(), this.rectSelection.set.get(0) || this.rectSelection.set.add(this.nested.rect(o.width, o.height).addClass(this.options.classRect)), this.options.points.length && this.rectSelection.set.length() < 2) {this.options.points.map(function (t, e) {var i = n.pointCoords(t, o),s = n.drawPoint(i.x, i.y).attr("class", n.options.classPoints + "_" + t).on("mousedown", r(t)).on("touchstart", r(t));n.rectSelection.set.add(s);}), this.rectSelection.set.each(function () {this.addClass(n.options.classPoints);});}if (this.options.rotationPoint && (this.options.points && !this.rectSelection.set.get(9) || !this.options.points && !this.rectSelection.set.get(1))) {var e = function e(t) {(t = t || window.event).preventDefault ? t.preventDefault() : t.returnValue = !1, t.stopPropagation();var e = t.pageX || t.touches[0].pageX,i = t.pageY || t.touches[0].pageY;n.el.fire("rot", { x: e, y: i, event: t });},i = this.drawPoint(o.width / 2, 20).attr("class", this.options.classPoints + "_rot").on("touchstart", e).on("mousedown", e);this.rectSelection.set.add(i);}}, i.prototype.handler = function () {var t = this.el.bbox();this.nested.matrix(new SVG.Matrix(this.el).translate(t.x, t.y)), this.rectSelection.isSelected && this.updateRectSelection(), this.pointSelection.isSelected && this.updatePointSelection();}, i.prototype.observe = function () {var t = this;if (MutationObserver) {if (this.rectSelection.isSelected || this.pointSelection.isSelected) this.observerInst = this.observerInst || new MutationObserver(function () {t.handler();}), this.observerInst.observe(this.el.node, { attributes: !0 });else try {this.observerInst.disconnect(), delete this.observerInst;} catch (t) {}} else this.el.off("DOMAttrModified.select"), (this.rectSelection.isSelected || this.pointSelection.isSelected) && this.el.on("DOMAttrModified.select", function () {t.handler();});}, i.prototype.cleanup = function () {!this.rectSelection.isSelected && this.rectSelection.set && (this.rectSelection.set.each(function () {this.remove();}), this.rectSelection.set.clear(), delete this.rectSelection.set), !this.pointSelection.isSelected && this.pointSelection.set && (this.pointSelection.set.each(function () {this.remove();}), this.pointSelection.set.clear(), delete this.pointSelection.set), this.pointSelection.isSelected || this.rectSelection.isSelected || (this.nested.remove(), delete this.nested);}, SVG.extend(SVG.Element, { selectize: function selectize(t, e) {return "object" == (typeof t === "undefined" ? "undefined" : _typeof(t)) && (e = t, t = !0), (this.remember("_selectHandler") || new i(this)).init(void 0 === t || t, e || {}), this;} }), SVG.Element.prototype.selectize.defaults = { points: ["lt", "rt", "rb", "lb", "t", "r", "b", "l"], pointsExclude: [], classRect: "svg_select_boundingRect", classPoints: "svg_select_points", pointSize: 7, rotationPoint: !0, deepSelect: !1, pointType: "circle" };}();



console.clear();
var countRect = 0;
var pressed = false;
var imgTable = 'data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9JzMwMHB4JyB3aWR0aD0nMzAwcHgnICBmaWxsPSIjMDAwMDAwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgNTAgNTAiIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDUwIDUwIiB4bWw6c3BhY2U9InByZXNlcnZlIj48Zz48cGF0aCBmaWxsPSIjMDAwMDAwIiBkPSJNNDQuMTEzLDI0LjY5OWMwLDQuODg5LTguNTI5LDguODU0LTE5LjA0OSw4Ljg1NGMtMTAuNTIxLDAtMTkuMDUyLTMuOTY1LTE5LjA1Mi04Ljg1NCAgIGMwLTQuODg3LDguNTMtOC44NSwxOS4wNTItOC44NUMzNS41ODQsMTUuODUsNDQuMTEzLDE5LjgxMyw0NC4xMTMsMjQuNjk5eiI+PC9wYXRoPjxnPjxwYXRoIGZpbGw9IiMwMDAwMDAiIGQ9Ik0yMy44NTcsMTIuMjkxYzAsMS4yMDUtMC43MDEsMi4xODQtMS41NjUsMi4xODRoLTguODQ0Yy0wLjg2NSwwLTEuNTY2LTAuOTc5LTEuNTY2LTIuMTg0bDAsMCAgICBjMC0xLjIwMywwLjcwMS0yLjE4MiwxLjU2Ni0yLjE4Mmg4Ljg0NEMyMy4xNTYsMTAuMTA5LDIzLjg1NywxMS4wODgsMjMuODU3LDEyLjI5MUwyMy44NTcsMTIuMjkxeiI+PC9wYXRoPjxwYXRoIGZpbGw9IiMwMDAwMDAiIGQ9Ik0zOC4yNDYsMTIuMjkxYzAsMS4yMDUtMC43MDEsMi4xODQtMS41NjgsMi4xODRoLTguODRjLTAuODY5LDAtMS41NjgtMC45NzktMS41NjgtMi4xODRsMCwwICAgIGMwLTEuMjAzLDAuNjk5LTIuMTgyLDEuNTY4LTIuMTgyaDguODRDMzcuNTQ1LDEwLjEwOSwzOC4yNDYsMTEuMDg4LDM4LjI0NiwxMi4yOTFMMzguMjQ2LDEyLjI5MXoiPjwvcGF0aD48L2c+PGc+PHBhdGggZmlsbD0iIzAwMDAwMCIgZD0iTTIzLjg1NywzNy43MTFjMCwxLjIwNS0wLjcwMSwyLjE4LTEuNTY1LDIuMThoLTguODQ0Yy0wLjg2NSwwLTEuNTY2LTAuOTc1LTEuNTY2LTIuMThsMCwwICAgIGMwLTEuMjA1LDAuNzAxLTIuMTgyLDEuNTY2LTIuMTgyaDguODQ0QzIzLjE1NiwzNS41MjksMjMuODU3LDM2LjUwNiwyMy44NTcsMzcuNzExTDIzLjg1NywzNy43MTF6Ij48L3BhdGg+PHBhdGggZmlsbD0iIzAwMDAwMCIgZD0iTTM4LjI0NiwzNy43MTFjMCwxLjIwNS0wLjcwMSwyLjE4LTEuNTY4LDIuMThoLTguODRjLTAuODY5LDAtMS41NjgtMC45NzUtMS41NjgtMi4xOGwwLDAgICAgYzAtMS4yMDUsMC42OTktMi4xODIsMS41NjgtMi4xODJoOC44NEMzNy41NDUsMzUuNTI5LDM4LjI0NiwzNi41MDYsMzguMjQ2LDM3LjcxMUwzOC4yNDYsMzcuNzExeiI+PC9wYXRoPjwvZz48cGF0aCBmaWxsPSIjMDAwMDAwIiBkPSJNMy4wMDksMTguNzE1YzEuMTQ0LDAsMi4wNzIsMC42OTksMi4wNzIsMS41NjN2OC44NDRjMCwwLjg2NS0wLjkyOSwxLjU2OC0yLjA3MiwxLjU2OGwwLDAgICBjLTEuMTQxLDAtMi4wNjktMC43MDMtMi4wNjktMS41Njh2LTguODQ0QzAuOTQsMTkuNDE0LDEuODY5LDE4LjcxNSwzLjAwOSwxOC43MTVMMy4wMDksMTguNzE1eiI+PC9wYXRoPjxwYXRoIGZpbGw9IiMwMDAwMDAiIGQ9Ik00Ny4wNDcsMTguNzE1YzEuMTExLDAsMi4wMTQsMC42OTksMi4wMTQsMS41NjN2OC44NDRjMCwwLjg2NS0wLjkwMiwxLjU2OC0yLjAxNCwxLjU2OGwwLDAgICBjLTEuMTEzLDAtMi4wMTYtMC43MDMtMi4wMTYtMS41Njh2LTguODQ0QzQ1LjAzMSwxOS40MTQsNDUuOTM0LDE4LjcxNSw0Ny4wNDcsMTguNzE1TDQ3LjA0NywxOC43MTV6Ij48L3BhdGg+PC9nPjwvc3ZnPg==';

var d = SVG('drawing');

var button = document.querySelector('.add-rect');
var btnExport = document.querySelector('.export');
var tables = [];
button.onclick = function () {
  var el = d.image(imgTable, 100, 100).draggable({ snapToGrid: 20 });

  function selectUnselect() {
    if (el._memory._selectHandler && el._memory._selectHandler.rectSelection.isSelected) {
      el.selectize(false);
    } else {
      el.selectize({ deepSelect: true, pointSize: 10 }).resize({ snapToGrid: 20, snapToAngle: 90 });
    }
  }

  el.dblclick(selectUnselect);

  var timer = void 0;

  el.touchstart(function () {
    timer = setTimeout(function () {
      selectUnselect();
    }, 1000);
  });

  el.touchend(function () {
    clearTimeout(timer);
  });

  tables.push(el);
};

btnExport.onclick = exportSvg;

function exportSvg() {
  tables.forEach(function (x) {
    x.draggable(false);
    x.selectize(false);
  });
  console.log(d.svg());
}